
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Informe Taller PostgreSQL Python &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'informe_taller_postgres';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Finforme_taller_postgres.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/informe_taller_postgres.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Informe Taller PostgreSQL Python</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conexion-con-docker-y-creacion-de-un-cursor">Conexión con Docker y creación de un cursor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#crear-la-tabla-nombrada-employees-explicar-que-tarea-realiza-la-consulta-realizada-y-mostrar-en-pantalla-la-tabla">1. Crear la tabla nombrada: employees, explicar que tarea realiza la consulta realizada y mostrar en pantalla la tabla</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#crear-la-tabla-courses">Crear la tabla courses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#insertar-datos-en-la-tabla-courses">Insertar datos en la tabla courses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eliminar-los-cursos-que-no-estan-en-modo-borrador-ni-publicados">Eliminar los cursos que no están en modo borrador ni publicados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recuento-de-todos-los-cursos-publicados-por-autor">Recuento de todos los cursos publicados por autor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#crear-la-base-de-datos-users">Crear la base de datos users</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#insertar-valores">Insertar valores</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#consultas">Consultas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numero-de-usuarios-creados-por-ano">Número de usuarios creados por año</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dias-de-nacimiento-de-todos-los-usuarios-nacidos-en-el-mes-may">Días de nacimiento de todos los usuarios nacidos en el mes MAY</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#obtener-los-nombres-e-ids-de-correo-electronico-de-los-usuarios-anadidos-en-el-ano-2019">Obtener los nombres e ids de correo electrónico de los usuarios añadidos en el año 2019</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numero-de-usuarios-por-genero">Número de usuarios por género</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ultimos-4-digitos-de-los-ids-unicos">Últimos 4 dígitos de los ids únicos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recuento-de-usuarios-en-funcion-del-codigo-del-pais">Recuento de usuarios en función del código del país</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cardano">Cardano</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#candlestick-plot">Candlestick plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio">Análisis exploratorio</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#medias-moviles">Medias Móviles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-del-cambio-porcentual-diario">Distribución del cambio porcentual diario</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#porcentaje-del-cambio-diario-boxplot">Porcentaje del cambio diario Boxplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evolucion-del-precio-de-cierre">Evolución del precio de cierre</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="informe-taller-postgresql-python">
<h1>Informe Taller PostgreSQL Python<a class="headerlink" href="#informe-taller-postgresql-python" title="Link to this heading">#</a></h1>
<p>Por: Shadia Jaafar Ferreira y Mariana Castañeda</p>
<p>Iniciamos creando la imagen y la base de datos desde docker. La cual tiene la siguiente información de conexión:</p>
<ul class="simple">
<li><p>Host: localhost</p></li>
<li><p>Port: 5432</p></li>
<li><p>Usuario: myname_user</p></li>
<li><p>Contraseña: password</p></li>
<li><p>Database name: myname_db</p></li>
</ul>
<p>A continuación, se muestra el contenedor docker creado.</p>
<p><img alt="Contenedor Docker" src="_images/docker.png" /></p>
<p>Ahora, realicemos la conexión con PgAdmin.</p>
<p><img alt="Conexión con PgAdmin" src="_images/pgadmin.jpg" /></p>
<section id="conexion-con-docker-y-creacion-de-un-cursor">
<h2>Conexión con Docker y creación de un cursor<a class="headerlink" href="#conexion-con-docker-y-creacion-de-un-cursor" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psycopg2</span>
<span class="kn">from</span> <span class="nn">psycopg2</span> <span class="kn">import</span> <span class="n">Error</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">psycopg2</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">from</span> <span class="nn">psycopg2</span> <span class="kn">import</span> <span class="n">Error</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;psycopg2&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_connection</span><span class="p">():</span>
    <span class="n">connection</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">connection</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="s2">&quot;myname_user&quot;</span><span class="p">,</span>
                                      <span class="n">password</span><span class="o">=</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
                                      <span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span>
                                      <span class="n">port</span><span class="o">=</span><span class="s2">&quot;5432&quot;</span><span class="p">,</span>
                                      <span class="n">database</span><span class="o">=</span><span class="s2">&quot;myname_db&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conexión a PostgreSQL establecida&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">connection</span>

    <span class="k">except</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">,</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al conectar con PostgreSQL:&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">connection</span><span class="p">:</span>
            <span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Conexión a PostgreSQL cerrada&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">,</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">Error</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error al cerrar la conexión con PostgreSQL:&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">get_dsn_parameters</span><span class="p">(),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT version();&quot;</span><span class="p">)</span>
    <span class="n">record</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Estás conectado a - &quot;</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
{&#39;user&#39;: &#39;myname_user&#39;, &#39;channel_binding&#39;: &#39;prefer&#39;, &#39;dbname&#39;: &#39;myname_db&#39;, &#39;host&#39;: &#39;localhost&#39;, &#39;port&#39;: &#39;5432&#39;, &#39;options&#39;: &#39;&#39;, &#39;sslmode&#39;: &#39;prefer&#39;, &#39;sslcompression&#39;: &#39;0&#39;, &#39;sslcertmode&#39;: &#39;allow&#39;, &#39;sslsni&#39;: &#39;1&#39;, &#39;ssl_min_protocol_version&#39;: &#39;TLSv1.2&#39;, &#39;gssencmode&#39;: &#39;disable&#39;, &#39;krbsrvname&#39;: &#39;postgres&#39;, &#39;gssdelegation&#39;: &#39;0&#39;, &#39;target_session_attrs&#39;: &#39;any&#39;, &#39;load_balance_hosts&#39;: &#39;disable&#39;} 

Estás conectado a -  (&#39;PostgreSQL 16.2 (Debian 16.2-1.pgdg120+2) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14) 12.2.0, 64-bit&#39;,) 

Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="crear-la-tabla-nombrada-employees-explicar-que-tarea-realiza-la-consulta-realizada-y-mostrar-en-pantalla-la-tabla">
<h2>1. Crear la tabla nombrada: employees, explicar que tarea realiza la consulta realizada y mostrar en pantalla la tabla<a class="headerlink" href="#crear-la-tabla-nombrada-employees-explicar-que-tarea-realiza-la-consulta-realizada-y-mostrar-en-pantalla-la-tabla" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;DROP TABLE IF EXISTS employees&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE TABLE employees(</span>
<span class="s1">    employee_id INTEGER</span>
<span class="s1">   , first_name VARCHAR(20)</span>
<span class="s1">   , last_name VARCHAR(25)</span>
<span class="s1">   , email VARCHAR(25)</span>
<span class="s1">   , phone_number VARCHAR(20)</span>
<span class="s1">   , hire_date DATE</span>
<span class="s1">   , job_id VARCHAR(10)</span>
<span class="s1">   , salary NUMERIC(8,2)</span>
<span class="s1">   , commission_pct NUMERIC(2,2)</span>
<span class="s1">   , manager_id INTEGER</span>
<span class="s1">   , department_id INTEGER);</span>
<span class="s1">    &#39;&#39;&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table created successfully&quot;</span><span class="p">)</span>
    
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE UNIQUE INDEX emp_emp_id_pk</span>
<span class="s1">         ON employees (employee_id);&#39;&#39;&#39;</span><span class="p">)</span>
    

    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39; ALTER TABLE employees ADD</span>
<span class="s1">        PRIMARY KEY (employee_id); &#39;&#39;&#39;</span><span class="p">)</span>
    
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;SELECT * FROM employees LIMIT 10;&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;SELECT count(1) FROM employees; &#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Completed Tasks&quot;</span><span class="p">)</span>
    
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
Table created successfully
Completed Tasks
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
<p>Primeramente se crea una consulta llamada “CREATE TABLE employees” de la cual se ramifican las siguientes columnas first_name con una longitud de caracteres posibles de máximo veinte, last_name con una longitud de máximo veinticinco, email con una longitud máxima de veinticinco, phone_number con una longitud de máximo veinticinco, hire_date para expresar valores que representan una fecha sin información de tiempo, como el año, el mes y el día, también se encuentra la columna de job_id, salary donde la columna puede almacenar números con hasta ocho dígitos en total, de los cuales dos serán dígitos decimales, commission_pct en la cual la columna almacenara hasta dos dígitos de los cuales dos serán decimales, como ultimas columnas se encuentran manager_id y department_id las cuales estarán expresadas en números enteros, posteriormente re realiza la consulta CREATE UNIQUE INDEX para crear un índice único el la tabla, se ejecuta ON employees (employee_id) lo que significa que se está creando un índice en la tabla “employees” y se especifica que el índice se basará en la columna “employee_id”, se agrega ALTER TABLE employees ADD para agregar una columna en la tabla especificada, se usa PRIMARY KEY (employee_id) para expresar la columna “employee_id” como la clave primaria, a continuación se ejecuta SELECT * FROM employees LIMIT 10 para seleccionar los primeros 10 registros de la tabla “employees”, finalmente se agrega SELECT count(1) FROM employees para obtener el número total de filas en la tabla “employees”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM employees&quot;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;employee_id = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;first_name = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;last_name = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;email = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;phone_number = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hire_date = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;job_id = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;salary = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;commission_pct = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;manager_id = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;department_id = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="crear-la-tabla-courses">
<h2>Crear la tabla courses<a class="headerlink" href="#crear-la-tabla-courses" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;DROP TABLE IF EXISTS courses&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE TABLE courses(</span>
<span class="s1">        course_id SERIAL PRIMARY KEY NOT NULL, course_name VARCHAR(60),</span>
<span class="s1">        course_author VARCHAR(40), course_status VARCHAR(10),</span>
<span class="s1">        course_published_dt DATE)&#39;&#39;&#39;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table created sucessfully&quot;</span><span class="p">)</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
Table created sucessfully
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="insertar-datos-en-la-tabla-courses">
<h2>Insertar datos en la tabla courses<a class="headerlink" href="#insertar-datos-en-la-tabla-courses" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;INSERT INTO courses(course_name, course_author, course_status, course_published_dt)</span>
<span class="s1">                   VALUES </span>
<span class="s1">                   (&#39;Programming using Python&#39;, &#39;Bob Dillon&#39;, &#39;published&#39;, &#39;2020-09-30&#39;),</span>
<span class="s1">                   (&#39;Data Engineering using Python&#39;, &#39;Bob Dillon&#39;, &#39;published&#39;, &#39;2020-07-15&#39;),</span>
<span class="s1">                   (&#39;Data Engineering using Scala&#39;, &#39;Elvis Presley&#39;, &#39;draft&#39;, null),</span>
<span class="s1">                   (&#39;Programming using Scala&#39;, &#39;Elvis Presley&#39;, &#39;published&#39;, &#39;2020-05-12&#39;),</span>
<span class="s1">                   (&#39;Programing using Java&#39;, &#39;Mike Jack&#39;, &#39;inactive&#39;, &#39;2020-08-12&#39;),</span>
<span class="s1">                   (&#39;Web Applications - Java Spring&#39;, &#39;Mike Jack&#39;, &#39;draft&#39;, null),</span>
<span class="s1">                   (&#39;Pipeline Orchestration -  Python&#39;, &#39;Bob Dillon&#39;, &#39;draft&#39;, null),</span>
<span class="s1">                   (&#39;Streaming Pipelines - Python&#39;, &#39;Bob Dillon&#39;, &#39;published&#39;, &#39;2020-10-05&#39;),</span>
<span class="s1">                   (&#39;Web Applications - Scala Play&#39;, &#39;Elvis Presley&#39;, &#39;inactive&#39;, &#39;2020-09-30&#39;),</span>
<span class="s1">                   (&#39;Web Applications - Python Django&#39;, &#39;Bob Dillon&#39;, &#39;published&#39;, &#39;2020-06-23&#39;),</span>
<span class="s1">                   (&#39;Server Automation - Ansible&#39;, &#39;Uncle Sam&#39;, &#39;published&#39;, &#39;2020-07-05&#39;)</span>
<span class="s1">                   &#39;&#39;&#39;</span><span class="p">);</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inserted Data&quot;</span><span class="p">)</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
Inserted Data
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="eliminar-los-cursos-que-no-estan-en-modo-borrador-ni-publicados">
<h2>Eliminar los cursos que no están en modo borrador ni publicados<a class="headerlink" href="#eliminar-los-cursos-que-no-estan-en-modo-borrador-ni-publicados" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;DELETE FROM courses WHERE course_status &lt;&gt; &#39;draft&#39; AND course_status &lt;&gt; &#39;published&#39; &#39;&#39;&#39;</span><span class="p">);</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of rows deleted :&quot;</span><span class="p">,</span> <span class="n">cursor</span><span class="o">.</span><span class="n">rowcount</span><span class="p">)</span>

    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM courses&quot;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;course_id = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;course_name = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;course_author = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;course_status = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;course_published_dt = &quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Operation done successfully&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
   <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
Total number of rows deleted : 2
course_id =  1
course_name =  Programming using Python
course_author =  Bob Dillon
course_status =  published
course_published_dt =  2020-09-30 

course_id =  2
course_name =  Data Engineering using Python
course_author =  Bob Dillon
course_status =  published
course_published_dt =  2020-07-15 

course_id =  3
course_name =  Data Engineering using Scala
course_author =  Elvis Presley
course_status =  draft
course_published_dt =  None 

course_id =  4
course_name =  Programming using Scala
course_author =  Elvis Presley
course_status =  published
course_published_dt =  2020-05-12 

course_id =  6
course_name =  Web Applications - Java Spring
course_author =  Mike Jack
course_status =  draft
course_published_dt =  None 

course_id =  7
course_name =  Pipeline Orchestration -  Python
course_author =  Bob Dillon
course_status =  draft
course_published_dt =  None 

course_id =  8
course_name =  Streaming Pipelines - Python
course_author =  Bob Dillon
course_status =  published
course_published_dt =  2020-10-05 

course_id =  10
course_name =  Web Applications - Python Django
course_author =  Bob Dillon
course_status =  published
course_published_dt =  2020-06-23 

course_id =  11
course_name =  Server Automation - Ansible
course_author =  Uncle Sam
course_status =  published
course_published_dt =  2020-07-05 

Operation done successfully
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="recuento-de-todos-los-cursos-publicados-por-autor">
<h2>Recuento de todos los cursos publicados por autor<a class="headerlink" href="#recuento-de-todos-los-cursos-publicados-por-autor" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT course_author, COUNT(*) AS total_rows FROM courses GROUP BY course_author ORDER BY total_rows DESC&quot;</span><span class="p">)</span>

    <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;course_author =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;total_rows =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Operación realizada exitosamente&quot;</span><span class="p">)</span>
    
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
course_author = Bob Dillon
total_rows = 5 

course_author = Elvis Presley
total_rows = 2 

course_author = Uncle Sam
total_rows = 1 

course_author = Mike Jack
total_rows = 1 

Operación realizada exitosamente
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="crear-la-base-de-datos-users">
<h2>Crear la base de datos users<a class="headerlink" href="#crear-la-base-de-datos-users" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;DROP TABLE IF EXISTS users&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;CREATE TABLE users(</span>
<span class="s1">    user_id SERIAL PRIMARY KEY,</span>
<span class="s1">    user_first_name VARCHAR(30),</span>
<span class="s1">    user_last_name VARCHAR(30),</span>
<span class="s1">    user_email_id VARCHAR(50),</span>
<span class="s1">    user_gender VARCHAR(1),</span>
<span class="s1">    user_unique_id VARCHAR(15),</span>
<span class="s1">    user_phone_no VARCHAR(20),</span>
<span class="s1">    user_dob DATE,</span>
<span class="s1">    created_ts TIMESTAMP)&#39;&#39;&#39;</span><span class="p">);</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Table users created&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
Table users created
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
<section id="insertar-valores">
<h3>Insertar valores<a class="headerlink" href="#insertar-valores" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;INSERT INTO users (user_first_name, user_last_name, user_email_id, user_gender, </span>
<span class="s1">    user_unique_id, user_phone_no, user_dob, created_ts)</span>
<span class="s1">     VALUES</span>
<span class="s1">    (&#39;Giuseppe&#39;, &#39;Bode&#39;, &#39;gbode0@imgur.com&#39;, &#39;M&#39;, &#39;88833-8759&#39;, </span>
<span class="s1">     &#39;+86 (764) 443-1967&#39;, &#39;1973-05-31&#39;, &#39;2018-04-15 12:13:38&#39;),</span>
<span class="s1">    (&#39;Lexy&#39;, &#39;Gisbey&#39;, &#39;lgisbey1@mail.ru&#39;, &#39;F&#39;, &#39;262501-029&#39;, </span>
<span class="s1">     &#39;+86 (751) 160-3742&#39;, &#39;2003-05-31&#39;, &#39;2020-12-29 06:44:09&#39;),</span>
<span class="s1">    (&#39;Karel&#39;, &#39;Claringbold&#39;, &#39;kclaringbold2@yale.edu&#39;, &#39;F&#39;, &#39;391-33-2823&#39;, </span>
<span class="s1">     &#39;+62 (445) 471-2682&#39;, &#39;1985-11-28&#39;, &#39;2018-11-19 00:04:08&#39;),</span>
<span class="s1">    (&#39;Marv&#39;, &#39;Tanswill&#39;, &#39;mtanswill3@dedecms.com&#39;, &#39;F&#39;, &#39;1195413-80&#39;, </span>
<span class="s1">     &#39;+62 (497) 736-6802&#39;, &#39;1998-05-24&#39;, &#39;2018-11-19 16:29:43&#39;),</span>
<span class="s1">    (&#39;Gertie&#39;, &#39;Espinoza&#39;, &#39;gespinoza4@nationalgeographic.com&#39;, &#39;M&#39;, &#39;471-24-6869&#39;, </span>
<span class="s1">     &#39;+249 (687) 506-2960&#39;, &#39;1997-10-30&#39;, &#39;2020-01-25 21:31:10&#39;),</span>
<span class="s1">    (&#39;Saleem&#39;, &#39;Danneil&#39;, &#39;sdanneil5@guardian.co.uk&#39;, &#39;F&#39;, &#39;192374-933&#39;, </span>
<span class="s1">     &#39;+63 (810) 321-0331&#39;, &#39;1992-03-08&#39;, &#39;2020-11-07 19:01:14&#39;),</span>
<span class="s1">    (&#39;Rickert&#39;, &#39;O&#39;&#39;Shiels&#39;, &#39;roshiels6@wikispaces.com&#39;, &#39;M&#39;, &#39;749-27-47-52&#39;, </span>
<span class="s1">     &#39;+86 (184) 759-3933&#39;, &#39;1972-11-01&#39;, &#39;2018-03-20 10:53:24&#39;),</span>
<span class="s1">    (&#39;Cybil&#39;, &#39;Lissimore&#39;, &#39;clissimore7@pinterest.com&#39;, &#39;M&#39;, &#39;461-75-4198&#39;, </span>
<span class="s1">     &#39;+54 (613) 939-6976&#39;, &#39;1978-03-03&#39;, &#39;2019-12-09 14:08:30&#39;),</span>
<span class="s1">    (&#39;Melita&#39;, &#39;Rimington&#39;, &#39;mrimington8@mozilla.org&#39;, &#39;F&#39;, &#39;892-36-676-2&#39;, </span>
<span class="s1">     &#39;+48 (322) 829-8638&#39;, &#39;1995-12-15&#39;, &#39;2018-04-03 04:21:33&#39;),</span>
<span class="s1">    (&#39;Benetta&#39;, &#39;Nana&#39;, &#39;bnana9@google.com&#39;, &#39;M&#39;, &#39;197-54-1646&#39;, </span>
<span class="s1">     &#39;+420 (934) 611-0020&#39;, &#39;1971-12-07&#39;, &#39;2018-10-17 21:02:51&#39;),</span>
<span class="s1">    (&#39;Gregorius&#39;, &#39;Gullane&#39;, &#39;ggullanea@prnewswire.com&#39;, &#39;F&#39;, &#39;232-55-52-58&#39;, </span>
<span class="s1">     &#39;+62 (780) 859-1578&#39;, &#39;1973-09-18&#39;, &#39;2020-01-14 23:38:53&#39;),</span>
<span class="s1">    (&#39;Una&#39;, &#39;Glayzer&#39;, &#39;uglayzerb@pinterest.com&#39;, &#39;M&#39;, &#39;898-84-336-6&#39;, </span>
<span class="s1">     &#39;+380 (840) 437-3981&#39;, &#39;1983-05-26&#39;, &#39;2019-09-17 03:24:21&#39;),</span>
<span class="s1">    (&#39;Jamie&#39;, &#39;Vosper&#39;, &#39;jvosperc@umich.edu&#39;, &#39;M&#39;, &#39;247-95-68-44&#39;, </span>
<span class="s1">     &#39;+81 (205) 723-1942&#39;, &#39;1972-03-18&#39;, &#39;2020-07-23 16:39:33&#39;),</span>
<span class="s1">    (&#39;Calley&#39;, &#39;Tilson&#39;, &#39;ctilsond@issuu.com&#39;, &#39;F&#39;, &#39;415-48-894-3&#39;, </span>
<span class="s1">     &#39;+229 (698) 777-4904&#39;, &#39;1987-06-12&#39;, &#39;2020-06-05 12:10:50&#39;),</span>
<span class="s1">    (&#39;Peadar&#39;, &#39;Gregorowicz&#39;, &#39;pgregorowicze@omniture.com&#39;, &#39;M&#39;, &#39;403-39-5-869&#39;, </span>
<span class="s1">     &#39;+7 (267) 853-3262&#39;, &#39;1996-09-21&#39;, &#39;2018-05-29 23:51:31&#39;),</span>
<span class="s1">    (&#39;Jeanie&#39;, &#39;Webling&#39;, &#39;jweblingf@booking.com&#39;, &#39;F&#39;, &#39;399-83-05-03&#39;, </span>
<span class="s1">     &#39;+351 (684) 413-0550&#39;, &#39;1994-12-27&#39;, &#39;2018-02-09 01:31:11&#39;),</span>
<span class="s1">    (&#39;Yankee&#39;, &#39;Jelf&#39;, &#39;yjelfg@wufoo.com&#39;, &#39;F&#39;, &#39;607-99-0411&#39;, </span>
<span class="s1">     &#39;+1 (864) 112-7432&#39;, &#39;1988-11-13&#39;, &#39;2019-09-16 16:09:12&#39;),</span>
<span class="s1">    (&#39;Blair&#39;, &#39;Aumerle&#39;, &#39;baumerleh@toplist.cz&#39;, &#39;F&#39;, &#39;430-01-578-5&#39;, </span>
<span class="s1">     &#39;+7 (393) 232-1860&#39;, &#39;1979-11-09&#39;, &#39;2018-10-28 19:25:35&#39;),</span>
<span class="s1">    (&#39;Pavlov&#39;, &#39;Steljes&#39;, &#39;psteljesi@macromedia.com&#39;, &#39;F&#39;, &#39;571-09-6181&#39;, </span>
<span class="s1">     &#39;+598 (877) 881-3236&#39;, &#39;1991-06-24&#39;, &#39;2020-09-18 05:34:31&#39;),</span>
<span class="s1">    (&#39;Darn&#39;, &#39;Hadeke&#39;, &#39;dhadekej@last.fm&#39;, &#39;M&#39;, &#39;478-32-02-87&#39;, </span>
<span class="s1">     &#39;+370 (347) 110-4270&#39;, &#39;1984-09-04&#39;, &#39;2018-02-10 12:56:00&#39;),</span>
<span class="s1">    (&#39;Wendell&#39;, &#39;Spanton&#39;, &#39;wspantonk@de.vu&#39;, &#39;F&#39;, null, </span>
<span class="s1">     &#39;+84 (301) 762-1316&#39;, &#39;1973-07-24&#39;, &#39;2018-01-30 01:20:11&#39;),</span>
<span class="s1">    (&#39;Carlo&#39;, &#39;Yearby&#39;, &#39;cyearbyl@comcast.net&#39;, &#39;F&#39;, null, </span>
<span class="s1">     &#39;+55 (288) 623-4067&#39;, &#39;1974-11-11&#39;, &#39;2018-06-24 03:18:40&#39;),</span>
<span class="s1">    (&#39;Sheila&#39;, &#39;Evitts&#39;, &#39;sevittsm@webmd.com&#39;, null, &#39;830-40-5287&#39;,</span>
<span class="s1">     null, &#39;1977-03-01&#39;, &#39;2020-07-20 09:59:41&#39;),</span>
<span class="s1">    (&#39;Sianna&#39;, &#39;Lowdham&#39;, &#39;slowdhamn@stanford.edu&#39;, null, &#39;778-0845&#39;, </span>
<span class="s1">     null, &#39;1985-12-23&#39;, &#39;2018-06-29 02:42:49&#39;),</span>
<span class="s1">    (&#39;Phylys&#39;, &#39;Aslie&#39;, &#39;paslieo@qq.com&#39;, &#39;M&#39;, &#39;368-44-4478&#39;, </span>
<span class="s1">     &#39;+86 (765) 152-8654&#39;, &#39;1984-03-22&#39;, &#39;2019-10-01 01:34:28&#39;) &#39;&#39;&#39;</span><span class="p">)</span>
    
    <span class="n">connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Values added&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
Values added
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="consultas">
<h2>Consultas<a class="headerlink" href="#consultas" title="Link to this heading">#</a></h2>
<section id="numero-de-usuarios-creados-por-ano">
<h3>Número de usuarios creados por año<a class="headerlink" href="#numero-de-usuarios-creados-por-ano" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;SELECT EXTRACT (YEAR FROM created_ts) AS created_year, COUNT(*) AS user_count FROM users GROUP BY created_year </span>
<span class="s1">                   ORDER BY created_year ASC&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;created_year =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_count =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Operación realizada exitosamente&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
created_year = 2018
user_count = 13 

created_year = 2019
user_count = 4 

created_year = 2020
user_count = 8 

Operación realizada exitosamente
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="dias-de-nacimiento-de-todos-los-usuarios-nacidos-en-el-mes-may">
<h3>Días de nacimiento de todos los usuarios nacidos en el mes MAY<a class="headerlink" href="#dias-de-nacimiento-de-todos-los-usuarios-nacidos-en-el-mes-may" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;SELECT user_id, user_dob, user_email_id,</span>
<span class="s1">                      INITCAP(to_char(user_dob, &#39;Day&#39;)) AS user_day_of_birth</span>
<span class="s1">                      FROM users</span>
<span class="s1">                      WHERE EXTRACT(MONTH FROM user_dob) = 5  </span>
<span class="s1">                      ORDER BY user_day_of_birth DESC&#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_id =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_dob =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_email_id =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_day_of_birth =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Operación realizada exitosamente&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
user_id = 1
user_dob = 1973-05-31
user_email_id = gbode0@imgur.com
user_day_of_birth = Thursday  

user_id = 12
user_dob = 1983-05-26
user_email_id = uglayzerb@pinterest.com
user_day_of_birth = Thursday  

user_id = 4
user_dob = 1998-05-24
user_email_id = mtanswill3@dedecms.com
user_day_of_birth = Sunday    

user_id = 2
user_dob = 2003-05-31
user_email_id = lgisbey1@mail.ru
user_day_of_birth = Saturday  

Operación realizada exitosamente
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="obtener-los-nombres-e-ids-de-correo-electronico-de-los-usuarios-anadidos-en-el-ano-2019">
<h3>Obtener los nombres e ids de correo electrónico de los usuarios añadidos en el año 2019<a class="headerlink" href="#obtener-los-nombres-e-ids-de-correo-electronico-de-los-usuarios-anadidos-en-el-ano-2019" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;SELECT user_id, user_first_name, user_last_name, user_email_id, created_ts,</span>
<span class="s1">                      UPPER(user_first_name || &#39; &#39; || user_last_name) AS &quot;user_name&quot;,</span>
<span class="s1">                      EXTRACT (YEAR FROM created_ts) AS created_year</span>
<span class="s1">                      FROM users</span>
<span class="s1">                      WHERE EXTRACT(YEAR FROM created_ts)  = 2019</span>
<span class="s1">                      ORDER BY user_name ASC  </span>
<span class="s1">                      &#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_id =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_name =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_email_id =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;created_ts =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;created_year =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Operación realizada exitosamente&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
user_id = 8
user_name = CYBIL LISSIMORE
user_email_id = clissimore7@pinterest.com
created_ts = 2019-12-09 14:08:30
created_year = 2019 

user_id = 25
user_name = PHYLYS ASLIE
user_email_id = paslieo@qq.com
created_ts = 2019-10-01 01:34:28
created_year = 2019 

user_id = 12
user_name = UNA GLAYZER
user_email_id = uglayzerb@pinterest.com
created_ts = 2019-09-17 03:24:21
created_year = 2019 

user_id = 17
user_name = YANKEE JELF
user_email_id = yjelfg@wufoo.com
created_ts = 2019-09-16 16:09:12
created_year = 2019 

Operación realizada exitosamente
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="numero-de-usuarios-por-genero">
<h3>Número de usuarios por género<a class="headerlink" href="#numero-de-usuarios-por-genero" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;SELECT </span>
<span class="s1">                          CASE </span>
<span class="s1">                              WHEN user_gender = &#39;M&#39; THEN &#39;Male&#39;</span>
<span class="s1">                              WHEN user_gender = &#39;F&#39; THEN &#39;Female&#39;</span>
<span class="s1">                              ELSE &#39;Not_specified&#39;</span>
<span class="s1">                          END AS user_gender,</span>
<span class="s1">                          COUNT(*) AS user_count</span>
<span class="s1">                      FROM users</span>
<span class="s1">                      GROUP BY user_gender</span>
<span class="s1">                      ORDER BY user_count DESC</span>
<span class="s1">                      &#39;&#39;&#39;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_gender =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_count =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Operación realizada exitosamente&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
user_gender = Female
user_count = 13 

user_gender = Male
user_count = 10 

user_gender = Not_specified
user_count = 2 

Operación realizada exitosamente
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="ultimos-4-digitos-de-los-ids-unicos">
<h3>Últimos 4 dígitos de los ids únicos<a class="headerlink" href="#ultimos-4-digitos-de-los-ids-unicos" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT user_id,</span>
<span class="s2">                        COALESCE(user_unique_id, &#39;Not Specified&#39;) AS user_unique_id,</span>
<span class="s2">                        CASE</span>
<span class="s2">                        WHEN user_unique_id IS NULL THEN &#39;&#39;</span>
<span class="s2">                        WHEN LENGTH(REPLACE(user_unique_id, &#39;-&#39;, &#39;&#39;)) &gt;= 9 THEN RIGHT(REPLACE(user_unique_id, &#39;-&#39;, &#39;&#39;), 4)</span>
<span class="s2">                        ELSE &#39;Invalid&#39;</span>
<span class="s2">                        END AS user_unique_id_last4</span>
<span class="s2">                    FROM users</span>
<span class="s2">                    ORDER BY user_id</span>
<span class="s2">                &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_id =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_unique_id =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_unique_id_last4 =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Operación realizada exitosamente&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
user_id = 1
user_unique_id = 88833-8759
user_unique_id_last4 = 8759 

user_id = 2
user_unique_id = 262501-029
user_unique_id_last4 = 1029 

user_id = 3
user_unique_id = 391-33-2823
user_unique_id_last4 = 2823 

user_id = 4
user_unique_id = 1195413-80
user_unique_id_last4 = 1380 

user_id = 5
user_unique_id = 471-24-6869
user_unique_id_last4 = 6869 

user_id = 6
user_unique_id = 192374-933
user_unique_id_last4 = 4933 

user_id = 7
user_unique_id = 749-27-47-52
user_unique_id_last4 = 4752 

user_id = 8
user_unique_id = 461-75-4198
user_unique_id_last4 = 4198 

user_id = 9
user_unique_id = 892-36-676-2
user_unique_id_last4 = 6762 

user_id = 10
user_unique_id = 197-54-1646
user_unique_id_last4 = 1646 

user_id = 11
user_unique_id = 232-55-52-58
user_unique_id_last4 = 5258 

user_id = 12
user_unique_id = 898-84-336-6
user_unique_id_last4 = 3366 

user_id = 13
user_unique_id = 247-95-68-44
user_unique_id_last4 = 6844 

user_id = 14
user_unique_id = 415-48-894-3
user_unique_id_last4 = 8943 

user_id = 15
user_unique_id = 403-39-5-869
user_unique_id_last4 = 5869 

user_id = 16
user_unique_id = 399-83-05-03
user_unique_id_last4 = 0503 

user_id = 17
user_unique_id = 607-99-0411
user_unique_id_last4 = 0411 

user_id = 18
user_unique_id = 430-01-578-5
user_unique_id_last4 = 5785 

user_id = 19
user_unique_id = 571-09-6181
user_unique_id_last4 = 6181 

user_id = 20
user_unique_id = 478-32-02-87
user_unique_id_last4 = 0287 

user_id = 21
user_unique_id = Not Specified
user_unique_id_last4 =  

user_id = 22
user_unique_id = Not Specified
user_unique_id_last4 =  

user_id = 23
user_unique_id = 830-40-5287
user_unique_id_last4 = 5287 

user_id = 24
user_unique_id = 778-0845
user_unique_id_last4 = Invalid 

user_id = 25
user_unique_id = 368-44-4478
user_unique_id_last4 = 4478 

Operación realizada exitosamente
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
<section id="recuento-de-usuarios-en-funcion-del-codigo-del-pais">
<h3>Recuento de usuarios en función del código del país<a class="headerlink" href="#recuento-de-usuarios-en-funcion-del-codigo-del-pais" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;SELECT CAST(substring(user_phone_no, &#39;\d+&#39;) AS INTEGER) AS country_code,</span>
<span class="s2">                    COUNT(*) AS user_count</span>
<span class="s2">                  FROM users</span>
<span class="s2">                  WHERE user_phone_no IS NOT NULL</span>
<span class="s2">                  GROUP BY country_code</span>
<span class="s2">                  ORDER BY country_code</span>
<span class="s2">               &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;country_code =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;user_count =&quot;</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Operación realizada exitosamente&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
country_code = 1
user_count = 1 

country_code = 7
user_count = 2 

country_code = 48
user_count = 1 

country_code = 54
user_count = 1 

country_code = 55
user_count = 1 

country_code = 62
user_count = 3 

country_code = 63
user_count = 1 

country_code = 81
user_count = 1 

country_code = 84
user_count = 1 

country_code = 86
user_count = 4 

country_code = 229
user_count = 1 

country_code = 249
user_count = 1 

country_code = 351
user_count = 1 

country_code = 370
user_count = 1 

country_code = 380
user_count = 1 

country_code = 420
user_count = 1 

country_code = 598
user_count = 1 

Operación realizada exitosamente
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="cardano">
<h2>Cardano<a class="headerlink" href="#cardano" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cardano</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/lihkir/Uninorte/main/AppliedStatisticMS/DataVisualizationRPython/Lectures/Python/PythonDataSets/ADA-USD.csv&quot;</span><span class="p">)</span>
<span class="n">cardano</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-10-01</td>
      <td>0.021678</td>
      <td>0.032226</td>
      <td>0.017354</td>
      <td>0.024969</td>
      <td>0.024969</td>
      <td>50068700.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-10-02</td>
      <td>0.024607</td>
      <td>0.030088</td>
      <td>0.019969</td>
      <td>0.025932</td>
      <td>0.025932</td>
      <td>57641300.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-10-03</td>
      <td>0.025757</td>
      <td>0.027425</td>
      <td>0.020690</td>
      <td>0.020816</td>
      <td>0.020816</td>
      <td>16997800.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-10-04</td>
      <td>0.020864</td>
      <td>0.022806</td>
      <td>0.020864</td>
      <td>0.021931</td>
      <td>0.021931</td>
      <td>9000050.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-10-05</td>
      <td>0.021951</td>
      <td>0.022154</td>
      <td>0.020859</td>
      <td>0.021489</td>
      <td>0.021489</td>
      <td>5562510.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cardano</span> <span class="o">=</span> <span class="n">cardano</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;Open&#39;</span><span class="p">:</span> <span class="s1">&#39;open&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;High&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;Low&#39;</span><span class="p">:</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;Close&#39;</span><span class="p">:</span> <span class="s1">&#39;close&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;Adj Close&#39;</span><span class="p">:</span> <span class="s1">&#39;adj_close&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;Volume&#39;</span><span class="p">:</span> <span class="s1">&#39;volume&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cardano</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>adj_close</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-10-01</td>
      <td>0.021678</td>
      <td>0.032226</td>
      <td>0.017354</td>
      <td>0.024969</td>
      <td>0.024969</td>
      <td>50068700.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-10-02</td>
      <td>0.024607</td>
      <td>0.030088</td>
      <td>0.019969</td>
      <td>0.025932</td>
      <td>0.025932</td>
      <td>57641300.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-10-03</td>
      <td>0.025757</td>
      <td>0.027425</td>
      <td>0.020690</td>
      <td>0.020816</td>
      <td>0.020816</td>
      <td>16997800.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-10-04</td>
      <td>0.020864</td>
      <td>0.022806</td>
      <td>0.020864</td>
      <td>0.021931</td>
      <td>0.021931</td>
      <td>9000050.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-10-05</td>
      <td>0.021951</td>
      <td>0.022154</td>
      <td>0.020859</td>
      <td>0.021489</td>
      <td>0.021489</td>
      <td>5562510.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Creamos el motor de la base de datos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>

<span class="n">base_de_datos</span> <span class="o">=</span> <span class="s1">&#39;myname_db&#39;</span>
<span class="n">nombre_usuario</span> <span class="o">=</span> <span class="s1">&#39;myname_user&#39;</span>
<span class="n">contraseña</span> <span class="o">=</span> <span class="s1">&#39;password&#39;</span>
<span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;localhost&#39;</span>
<span class="n">puerto</span> <span class="o">=</span> <span class="mi">5432</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;postgresql://</span><span class="si">{</span><span class="n">nombre_usuario</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">contraseña</span><span class="si">}</span><span class="s1">@</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">puerto</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">base_de_datos</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">cardano</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="n">base_de_datos</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1475
</pre></div>
</div>
</div>
</div>
<p>Aquí podemos visualizar la tabla que creamos de Cardano desde DBeaver.
<img alt="Tabla Cardano" src="_images/tabla.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">connection</span> <span class="o">=</span> <span class="n">create_connection</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT column_name FROM information_schema.columns WHERE table_name=&#39;myname_db&#39; ORDER BY ordinal_position;&quot;</span><span class="p">)</span>
    <span class="n">column_names</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
    
    <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">column_names</span><span class="p">]</span>
    
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM myname_db;&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
    
    <span class="n">cardano_sql</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>
    
    <span class="n">display</span><span class="p">(</span><span class="n">cardano_sql</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Operación realizada con éxito&quot;</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">close_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conexión a PostgreSQL establecida
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>adj_close</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-10-01</td>
      <td>0.021678</td>
      <td>0.032226</td>
      <td>0.017354</td>
      <td>0.024969</td>
      <td>0.024969</td>
      <td>50068700.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-10-02</td>
      <td>0.024607</td>
      <td>0.030088</td>
      <td>0.019969</td>
      <td>0.025932</td>
      <td>0.025932</td>
      <td>57641300.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-10-03</td>
      <td>0.025757</td>
      <td>0.027425</td>
      <td>0.020690</td>
      <td>0.020816</td>
      <td>0.020816</td>
      <td>16997800.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-10-04</td>
      <td>0.020864</td>
      <td>0.022806</td>
      <td>0.020864</td>
      <td>0.021931</td>
      <td>0.021931</td>
      <td>9000050.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-10-05</td>
      <td>0.021951</td>
      <td>0.022154</td>
      <td>0.020859</td>
      <td>0.021489</td>
      <td>0.021489</td>
      <td>5562510.0</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Operación realizada con éxito
Conexión a PostgreSQL cerrada
</pre></div>
</div>
</div>
</div>
<section id="candlestick-plot">
<h3>Candlestick plot<a class="headerlink" href="#candlestick-plot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Candlestick</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">cardano_sql</span><span class="o">.</span><span class="n">date</span><span class="p">,</span>
                                     <span class="nb">open</span> <span class="o">=</span> <span class="n">cardano_sql</span><span class="o">.</span><span class="n">open</span><span class="p">,</span> 
                                     <span class="n">high</span> <span class="o">=</span> <span class="n">cardano_sql</span><span class="o">.</span><span class="n">high</span><span class="p">,</span>
                                     <span class="n">low</span> <span class="o">=</span> <span class="n">cardano_sql</span><span class="o">.</span><span class="n">low</span><span class="p">,</span> 
                                     <span class="n">close</span> <span class="o">=</span> <span class="n">cardano_sql</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
                     <span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cardano USD (ADA-USD)&quot;</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Day&quot;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;ADA-USD&quot;</span><span class="p">,</span>
    <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">family</span><span class="o">=</span><span class="s2">&quot;Courier New, monospace&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;RebeccaPurple&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_rangeslider_visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="s2">&quot;notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Se puede observar que entre Julio del 2018 hasta febrero del 2021 el precio del blockchain se mantuvo constante. Sin embargo, en febrero tuvo patrón envolvente alcista, lo cual indica que precio subió y los compradores tuvieron el control. Posteriormente, a partir de mayo del 2021 presentó una caída bajista, pero en agosto volvío a tener un comportamiento alcista alcanzando su precio máximo de 3 USD el 2 de septiembre del 2021.</p>
</section>
</section>
<section id="analisis-exploratorio">
<h2>Análisis exploratorio<a class="headerlink" href="#analisis-exploratorio" title="Link to this heading">#</a></h2>
<p>Iniciemos verificando si la serie es estacionaria usando la prueba de Dickey Fuller</p>
<p>Ho: La serie no es estacionaria <br />
H1: La series sí es estacionaria</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADF Statistic: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -0.531337
p-value: 0.885755
</pre></div>
</div>
</div>
</div>
<p>Como el p-valor (0.88) es mayor a 0.05 no se rechaza la Hipótesis nula, por lo tanto la serie no es estacionaria</p>
<section id="medias-moviles">
<h3>Medias Móviles<a class="headerlink" href="#medias-moviles" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;ma10&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;ma20&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cardano_sql</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">trace1</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Candlestick</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span>
    <span class="nb">open</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">],</span>
    <span class="n">high</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">],</span>
    <span class="n">low</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">],</span>
    <span class="n">close</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="s1">&#39;y1&#39;</span>
<span class="p">)</span>

<span class="n">trace2</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;ma10&#39;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;royalblue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;10-day MA&#39;</span><span class="p">,</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="s1">&#39;y1&#39;</span>
<span class="p">)</span>

<span class="n">trace3</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;ma20&#39;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span>
    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;20-day MA&#39;</span><span class="p">,</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="s1">&#39;y1&#39;</span>
<span class="p">)</span>

<span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Candlestick Cardano con medias móviles&#39;</span><span class="p">,</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mf">0.35</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <span class="n">xaxis_rangeslider_visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">trace1</span><span class="p">,</span> <span class="n">trace2</span><span class="p">,</span> <span class="n">trace3</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="s2">&quot;notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Obbservamos que hay períodos donde las medias móviles se cruzan, lo que podría interpretarse como señales potenciales de compra o venta por parte de los traders. Además, el precio experimentó un aumento significativo alrededor de enero de 2021, seguido de una corrección y otra subida, lo que indica un mercado volátil con ciertos picos de interés o actividad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">cardano_sql</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;close&#39;</span><span class="p">,</span> <span class="n">facet_col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="s2">&quot;notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Se observa un aumento significativo en el precio comenzando aproximadamente a principios de 2021, con picos notables y cierta volatilidad en los precios. La forma general de la gráfica sugiere una tendencia alcista con fluctuaciones a corto plazo, que son comunes en los mercados de criptomonedas.</p>
</section>
<section id="distribucion-del-cambio-porcentual-diario">
<h3>Distribución del cambio porcentual diario<a class="headerlink" href="#distribucion-del-cambio-porcentual-diario" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;Daily_Return&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span> 
<span class="n">fig2</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">fig2</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Histogram</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;Daily_Return&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cardano&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">nbinsx</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">marker_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">))</span>

<span class="n">fig2</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribución del Cambio Porcentual Diario para Cardano&#39;</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Porcentaje de Cambio Diario&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">,</span>
    <span class="n">template</span><span class="o">=</span><span class="s1">&#39;plotly_white&#39;</span><span class="p">,</span>
    <span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;overlay&#39;</span>
<span class="p">)</span>

<span class="n">fig2</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="s2">&quot;notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\USUARIO\AppData\Local\Temp\ipykernel_2784\2429821019.py:3: FutureWarning:

The default fill_method=&#39;pad&#39; in Series.pct_change is deprecated and will be removed in a future version. Either fill in any non-leading NA values prior to calling pct_change or specify &#39;fill_method=None&#39; to not fill NA values.
</pre></div>
</div>
</div>
</div>
<p>La mayoría de los cambios se concentran cerca del cero, con una distribución que parece ser aproximadamente normal, lo que indica que los días con pequeñas fluctuaciones son más comunes. Hay algunas ocurrencias de cambios grandes, tanto positivos como negativos, pero estos son menos frecuentes.</p>
</section>
<section id="porcentaje-del-cambio-diario-boxplot">
<h3>Porcentaje del cambio diario Boxplot<a class="headerlink" href="#porcentaje-del-cambio-diario-boxplot" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig3</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="n">fig3</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;Daily_Return&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Cardano&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)))</span>

<span class="c1"># Actualizar el diseño del gráfico</span>
<span class="n">fig3</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Boxplot del Cambio Porcentual Diario para Cardano&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Porcentaje de Cambio Diario&#39;</span><span class="p">,</span>
    <span class="n">template</span><span class="o">=</span><span class="s1">&#39;plotly_white&#39;</span>
<span class="p">)</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">fig3</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="s2">&quot;notebook&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Este gráfico sugiere que mientras la mayoría de los cambios diarios están cerca de la mediana, hay días con movimientos de precio extremadamente altos que podrían ser de interés para análisis de volatilidad.</p>
</section>
<section id="evolucion-del-precio-de-cierre">
<h3>Evolución del precio de cierre<a class="headerlink" href="#evolucion-del-precio-de-cierre" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">cardano_sql</span><span class="p">[</span><span class="s1">&#39;close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Evolución de los Precios de Cierre a lo Largo del Tiempo (Escala Logarítmica)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Fecha&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Precio de Cierre&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Cardano&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4e7ac1db6354bad304a4768cc7de01ced5e685f0744f0df8603f5110d2297afe.png" src="_images/4e7ac1db6354bad304a4768cc7de01ced5e685f0744f0df8603f5110d2297afe.png" />
</div>
</div>
<p>Se observan picos significativos en el precio, lo que indica períodos de alta volatilidad o aumentos rápidos en el valor. Tras estos picos, también se ven correcciones en el precio.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conexion-con-docker-y-creacion-de-un-cursor">Conexión con Docker y creación de un cursor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#crear-la-tabla-nombrada-employees-explicar-que-tarea-realiza-la-consulta-realizada-y-mostrar-en-pantalla-la-tabla">1. Crear la tabla nombrada: employees, explicar que tarea realiza la consulta realizada y mostrar en pantalla la tabla</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#crear-la-tabla-courses">Crear la tabla courses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#insertar-datos-en-la-tabla-courses">Insertar datos en la tabla courses</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eliminar-los-cursos-que-no-estan-en-modo-borrador-ni-publicados">Eliminar los cursos que no están en modo borrador ni publicados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recuento-de-todos-los-cursos-publicados-por-autor">Recuento de todos los cursos publicados por autor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#crear-la-base-de-datos-users">Crear la base de datos users</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#insertar-valores">Insertar valores</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#consultas">Consultas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numero-de-usuarios-creados-por-ano">Número de usuarios creados por año</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dias-de-nacimiento-de-todos-los-usuarios-nacidos-en-el-mes-may">Días de nacimiento de todos los usuarios nacidos en el mes MAY</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#obtener-los-nombres-e-ids-de-correo-electronico-de-los-usuarios-anadidos-en-el-ano-2019">Obtener los nombres e ids de correo electrónico de los usuarios añadidos en el año 2019</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numero-de-usuarios-por-genero">Número de usuarios por género</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ultimos-4-digitos-de-los-ids-unicos">Últimos 4 dígitos de los ids únicos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recuento-de-usuarios-en-funcion-del-codigo-del-pais">Recuento de usuarios en función del código del país</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cardano">Cardano</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#candlestick-plot">Candlestick plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio">Análisis exploratorio</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#medias-moviles">Medias Móviles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-del-cambio-porcentual-diario">Distribución del cambio porcentual diario</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#porcentaje-del-cambio-diario-boxplot">Porcentaje del cambio diario Boxplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#evolucion-del-precio-de-cierre">Evolución del precio de cierre</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>